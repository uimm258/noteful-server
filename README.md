# Express Boilerplate!

This is a boilerplate project used for starting new projects!

## Set up

Complete the following steps to start a new project (NEW-PROJECT-NAME):

1. Clone this repository to your local machine `git clone BOILERPLATE-URL NEW-PROJECTS-NAME`
2. `cd` into the cloned repository
3. Make a fresh start of the git history for this project with `rm -rf .git && git init`
4. Install the node dependencies `npm install`
5. Move the example Environment file to `.env` that will be ignored by git and read by the express server `mv example.env .env`
6. Edit the contents of the `package.json` to use NEW-PROJECT-NAME instead of `"name": "express-boilerplate",`

## Scripts

Start the application `npm start`

Start nodemon for the application `npm run dev`

Run the tests `npm test`

## Deploying

When your new project is ready for deployment, add a new Heroku application with `heroku create`. This will make a new git remote called "heroku" and you can then `npm run deploy` which will push to this remote's master branch.



# essential packages to install
npm install
make a .env file and add TEST_DB_URL and the DB_URL that direct to your DB in localhost 
                    NODE_ENV=development
                    PORT=8000
                    TEST_DB_URL="postgresql://dunder_mifflin@localhost/noteful_test"
                    DB_URL="postgresql://dunder_mifflin@localhost/noteful"
npm i cors
npm i eslint
npm i express
npm i morgan
npm i nodemon
# database
npm i knex
npm i pg
npm i dotenv
# validation and security
npm i xss for validating inputs
npm i helmet
# testing 
npm i mocha
npm i chai
npm i supertest
npm install winston for error logging

# migrations and DB
# when using psql
to create a db:
createdb -U dunder_mifflin dbName  -- in the command line to create a DB
# db migrations
npm i postgrator-cli@3.2.0 -D   make a migrations folder, the file naming convention is 001.do.create_(tableName or thing you are creating) and 0001.undo.create_(same name as the do file)

then you need to make a postgrator-config.js file with 
                    require('dotenv').config();

                    module.exports = {
                    migrationsDirectory: 'migrations',
                    driver: 'pg',
                    'connectionString': (process.env.NODE_ENV === 'test')
                        ? process.env.TEST_DB_URL
                        : process.env.DB_URL,
                    };

then do a npm run migrate to update the DBs. Remember that in the .env files you need to direct towards the db you want as well.

# seeding your DB
to seed: make a seeds folder and place the files inside. naming convention is seed.bdName_tableName.sql
psql -U dunder_mifflin -d dbName -f ./seeds/seed.blogful_articles.sql  - do this in the command line not in psql

!~when seeding do not use double quotes, only use single quotes~!

# other useful things to remember
When cloning : 
git clone https://github.com/[YOUR-USERNAME]/express-boilerplate.git blogful-api
cd $_
rm -rf .git && git init
mv example.env .env
npm install
git add -A && git commit -m 'first commit'


# db table syntax
-- first remove any foreign key constraints
alter table if exists folders
drop column id;

--drop tables to make sure the tables will be clean
drop table if exists notes;

--create the project table that is the most independent table
create table notes (
    id integer primary key generated by default as identity,
    name text not null,
    content text not null,
    modified TIMESTAMPTZ default now() not null
)

# db seeding syntax 
insert into dbTableName ( id, name, content, modified, folder_id )
values ('','','','','',);


# BEFORE DEPLOY 
`heroku important steps`

 change the database url to DATABASE_URL from DB_URL

 you don't need to change the test_DB_URL because we don't use it in production. 

then manual check the package.json and make sure that you have postgrator into the dependencies,it might be only in the dev dependencies and heroku will ignore it. This means we can't migrate the files in the server

we type heroku run npm run migrate to get started on the migration. 

heroku pg:psql is a handy tool that will get us into the shell there. Then we can do \dt to see the tables in heroku

